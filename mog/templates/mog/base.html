{% load static %}
{% load i18n %}
{% load security %}

<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="description"
              content="{% block meta_description %}Matcom Online Grader. Programming contests, algorithms and mathematics.{% endblock %}">
        <meta name="keywords"
              content="programming algorithm contest competition informatics olympiads c++ java python graphs matcom" />

        <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
        <meta http-equiv="Cache-Control" max-age="0"/>
        <meta http-equiv="Pragma" content="no-cache" />

        {% block metas %}
            {# add meta tags here #}
        {% endblock %}
        <title>{% block title %}{% endblock %} | MatCom Online Grader</title>
        <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="{% static 'mog/images/favicon.ico' %}"/>

        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
        <link href="{% static 'mog/css/body.css' %}?v=6" rel="stylesheet"/>

        <!-- AddSense configuration -->
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

        <script>
            (adsbygoogle = window.adsbygoogle || []).push({
                google_ad_client: "ca-pub-2363660083477988",
                enable_page_level_ads: true
            });
        </script>

        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108230808-1"></script>
        <script>
          window.dataLayer = window.dataLayer || [];
          function gtag(){dataLayer.push(arguments);}
          gtag('js', new Date());

          gtag('config', 'UA-108230808-1');
        </script>

        {% block styles %}
            {# Additional styles here! #}
        {% endblock %}

        <style>
            .no-underline {
                text-decoration: none !important;
            }

            /* USED IN HOME */
            .first-post {
                margin-top: 0 !important;
            }

            /* USED IN SUBMIT */
            .CodeMirror {
                border: 1px solid #DDD;
                height: auto;
            }

            /* COMMENTS */
            img.media-object {
                height: 64px; width: 64px;
            }

            /* BIG TITLE IN SOME PAGES */
            h1.title, h2.title, h3.title, h4.title, h5.title {
                margin-top: 0 !important;
            }

            /* UNIFORM TEXT (used as small/medium titles) */
            .uniform-text {
                font-weight: bold;
                color: #999;
                text-transform: uppercase;
            }

            .uniform-text.uniform-small {  font-size: 11px; }
            .uniform-text.uniform-medium { font-size: 13px; }
            .uniform-text.uniform-big { font-size: 15px; }

            /* MARGIN  SHORTCUTS */
            .margin-left-0 { margin-left: 0px !important; }
            .margin-left-5 { margin-left: 5px !important; }
            .margin-left-10 { margin-left: 10px !important; }
            .margin-left-15 { margin-left: 15px !important; }
            .margin-left-20 { margin-left: 20px !important; }
            .margin-left-25 { margin-left: 25px !important; }

            .margin-top-0 { margin-top: 0px !important; }
            .margin-top-5 { margin-top: 5px !important; }
            .margin-top-10 { margin-top: 10px !important; }
            .margin-top-15 { margin-top: 15px !important; }
            .margin-top-20 { margin-top: 20px !important; }
            .margin-top-25 { margin-top: 25px !important; }

            .margin-bottom-0 { margin-bottom: 0px !important; }
            .margin-bottom-5 { margin-bottom: 5px !important; }
            .margin-bottom-10 { margin-bottom: 10px !important; }
            .margin-bottom-15 { margin-bottom: 15px !important; }
            .margin-bottom-20 { margin-bottom: 20px !important; }
            .margin-bottom-25 { margin-bottom: 25px !important; }

            .padding-0 { padding: 0 !important; }
            .margin-0 { margin: 0 !important; }

            /* Used mostly in wells */
            .bckg-white {
                background-color: white !important;
            }

            /* Contest Standing */
            .problem-solved { background-color: #DFF0D8; color: #468847; }
            .problem-failed { background-color: #F2DEDE; color: #B94A48; }
            .problem-pending { background-color: #9999FF; color: #000000; }
            .problem-solved-first { background-color: #B9D4AC; color: #39703A; }
            .contest-solved-first { background-color: #d49836; color: #704e1b; }

            .problem-solved-legend { background-color: #a0d497; color: #468847; }
            .problem-failed-legend { background-color: #e97d6c; color: #B94A48; }
            .problem-pending-legend { background-color: #7676d8; color: #000000; }
            .problem-solved-first-legend { background-color: #76a463; color: #39703A; }
            .contest-solved-first-legend { background-color: #d39736; color: #704e1b; }

            .token-input-list-facebook {
                width: 100% !important;
            }

            /* Used in helped text of a form */
            .form-help-text {
                color: #777;
                display: block;
                margin-top: 5px;
            }
            .form-help-text-checkbox {
                padding-left: 20px;
            }

            /* Used as a title of a well element */
            .well > .well-title {
                margin-top: 0;
                margin-bottom: 1.25rem;
                font-size: 1.6rem;
                font-weight: 700;
                line-height: 1.2;
            }
        </style>
    </head>

    <body>
        <nav class="navbar navbar-inverse navbar-fixed-top">
            <div class="container">
                <div id="navbar" class="navbar-collapse collapse">
                    <ul class="nav navbar-nav">
                        <li><a href="{% url 'mog:index' %}">{% trans 'Home' %}</a></li>
                        <li><a href="{% url 'mog:users' %}">{% trans 'Users' %}</a></li>
                        <li><a href="{% url 'mog:problems' %}">{% trans 'Problems' %}</a></li>
                        <li><a href="{% url 'mog:contests' %}">{% trans 'Contests' %}</a></li>
                        <li><a href="{% url 'mog:posts' %}">{% trans 'Posts' %}</a></li>
                        <li><a href="{% url 'mog:submissions' %}">{% trans 'Submissions' %}</a></li>
                        <li><a href="{% url 'mog:faq' %}">{% trans 'FAQ' %}</a></li>
                        <li>
                            <a href="https://www.paypal.com/donate/?hosted_button_id=H8DNJ354WNMZC" target="_blank">
                                <span style="font-size: 1em; vertical-align: middle;">❤️</span>
                                {% trans 'Donate' %}
                            </a>
                        </li>
                    </ul>
                    <ul class="nav navbar-nav navbar-right">
                        {% block user_login %}
                            {% include 'mog/user/_login.html' %}
                        {% endblock %}
                    </ul>
                </div>
            </div>
        </nav>

        <div class="container">
            <div class="row">
                <div class="page-header">
                    <div class="row">
                        <div class="col-md-3">
                            <a href="{% url 'mog:index' %}">
                                {# Change logo depending the day :) #}
                                {% if special_day == 'valentine' %}
                                    <img src="{% static 'mog/images/logo-valentine.png' %}" class="img-responsive"
                                         alt="MOG: Happy Valentine Day!"/>
                                {% elif special_day == 'christmas' %}
                                    <img src="{% static 'mog/images/logo-ch.png' %}" class="img-responsive"
                                         alt="MOG: Happy Christmas!"/>
                                {% elif special_day == 'halloween' %}
                                    <img src="{% static 'mog/images/logo-hw.png' %}" class="img-responsive"
                                         alt="MOG: Happy Halloween!"/>
                                {% elif special_day == 'thanksgiving' %}
                                    <img src="{% static 'mog/images/logo-tg.png' %}" class="img-responsive"
                                         alt="MOG: Happy Thanksgiving!"/>
                                {% else %}
                                    <img src="{% static 'mog/images/logo.png' %}" class="img-responsive"
                                         alt="MOG"/>
                                {% endif %}
                            </a>
                        </div>
                        <div class="col-md-9">
                            <div class="pull-right">
                                <form action="/i18n/setlang/" method="post" style="display: inline-block;">
                                    {% csrf_token %}
                                    <input type="hidden" name="language" value="es" />
                                    <a href="javascript:;" class="no-underline" onclick="this.parentNode.submit();">
                                        <img src="{% static 'mog/images/spa-flag.png' %}" alt="Spanish" class="flagSizeSmall"/>
                                    </a>
                                </form>
                                |
                                <form action="/i18n/setlang/" method="post" style="display: inline-block;">
                                    {% csrf_token %}
                                    <input type="hidden" name="language" value="en" />
                                    <a href="javascript:;" class="no-underline" onclick="this.parentNode.submit();">
                                        <img src="{% static 'mog/images/eng-flag.png' %}" alt="English" class="flagSizeSmall"/>
                                    </a>
                                </form>
                            </div>
                            <h1>Matcom Online Grader</h1>
                            <!-- <div class="alert alert-info" role="alert">
                                ℹ️ {% trans "We've recently migrated MOG to a new server with a different grader. As a result, some features—especially those related to submission evaluation—might not work correctly. If you encounter any issues, please report them by clicking the exclamation icon in the bottom right corner of the website." %}
                            </div> -->
                        </div>
                    </div>
                </div>
            </div>

            {% block messages %}
                {% include 'mog/includes/_messages.html' with messages=messages %}
            {% endblock %}

            {% block main %}
                <div class="row">
                    <div class="col-md-3">
                        {% block left %}
                            <div class="row">
                                {% comment %} User card showing stats {% endcomment %}
                                {% if user.is_authenticated %}
                                    <div class="col-md-12">
                                        <table class="table table-bordered table-striped">
                                            <tbody>
                                            <tr>
                                                <td colspan="3">
                                                    <div class="text-center">
                                                        {% include 'mog/user/_link.html' with user=user %}
                                                    </div>
                                                    <div class="text-center">
                                                        {% include 'mog/user/_image.html' with user=user width="80%" %}
                                                    </div>
                                                    {% if user|is_admin %}
                                                        <div class="text-center">
                                                            ( administrator )
                                                        </div>
                                                    {% endif %}
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <div class="center">{% trans 'Rating' %}</div>
                                                </td>
                                                <td>
                                                    <div class="center">{% trans 'Points' %}</div>
                                                </td>
                                                <td>
                                                    <div class="center">{% trans 'Solved' %}</div>
                                                </td>
                                            </tr>
                                            <tr>
                                                {% with profile=user.profile %}
                                                    <td>
                                                        <div class="center">{{ profile.rating }}</div>
                                                    </td>
                                                    <td>
                                                        <div class="center">{{ profile.points }}</div>
                                                    </td>
                                                    <td>
                                                        <div class="center">{{ profile.solved_problems }}</div>
                                                    </td>
                                                {% endwith %}
                                            </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                {% endif %}
                                {% comment %} Top rated users {% endcomment %}
                                <div class="col-md-12">
                                    <small class="uniform-text uniform-medium">{% trans 'Top rated users' %}</small>
                                    {% include 'mog/user/_top_rated_users.html' %}
                                </div>
                                {% comment %} Recent posts {% endcomment %}
                                <div class="col-md-12">
                                    <small class="uniform-text uniform-medium">{% trans 'Recent posts' %}</small>
                                    {% include 'mog/post/_recent_modified_posts.html' with posts=recent_modified_posts %}
                                </div>
                            </div>
                        {% endblock %}
                    </div>
                    <div class="col-md-9">
                        <section>
                            {% block content %}{% endblock %}
                        </section>
                    </div>
                </div>
            {% endblock %}

            <div id="report-issues"></div>

            <hr>

            <footer>
                <div class="center">
                    <p>&copy; 2016 - {% now "Y" %} Matcom Online Grader (MOG)</p>
                    <p>Server Time: {% now "jS F Y H:i" %}</p>
                    <p>
                        <a href="https://www.facebook.com/MatcomOnlineGrader" target="_blank" style="text-decoration: none;">
                            <img src="{% static 'mog/images/fl.png' %}" class="margin-right-5">
                        </a>
                        <a href="https://twitter.com/MatcomGrader" target="_blank" style="text-decoration: none;">
                            <img src="{% static 'mog/images/tl.png' %}" class="margin-left-5">
                        </a>
                    </p>
                    <p>
                        <a href="{% url 'mog:privacy' %}">
                            {% trans 'Privacy Policy' %}
                        </a>
                    </p>
                    <div class="d-flex justify-content-center flex-column align-items-center text-center margin-top-25">
                        <div>{% trans 'Sponsored by' %}</div>
                        <a href="https://www.clubesdeprogramacioncompetitiva.com">
                            <img src="{% static 'mog/images/cpc.webp' %}" class="img-fluid" width="256px" height="auto"
                                alt="Clubes de Programación Competitiva CPC" />
                        </a>
                    </div>
                </div>
            </footer>
        </div>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js" integrity="sha256-cCueBR6CsyA4/9szpPfrX3s49M9vUU5BgtiJj06wt/s=" crossorigin="anonymous"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>
        <script type="text/javascript" src="{% static 'mog/js/mog.js' %}"></script>

        {% comment %}
        Move this to an special file where we collect information
        during the time django is rendering its templates.
        {% endcomment %}
        <script>
            var CurrentUser = {
                csrftoken: '{{csrf_token}}',
                authenticated: ('{{user.is_authenticated}}' === 'True')
            };
        </script>

        <script crossorigin src="https://unpkg.com/react@16/umd/react.production.min.js"></script>
        <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>
        <script type="text/javascript" src="{% static 'frontend/dist/bundle.js' %}"></script>

        {% block scripts %}
            {# Additional scripts here! #}
        {% endblock %}

        <script>
            $(document).ready(function () {
                 $('[data-toggle="tooltip"]').tooltip();
                 $('[data-toggle="popover"]').popover();
                if (window.MOG !== undefined) {
                    window.MOG.initializeSummernote({{ user|is_admin|yesno:"true,false" }});
                    window.MOG.initializeSimpleMDE({{ user|is_admin|yesno:"true,false" }});
                }
            });
        </script>
    </body>
</html>